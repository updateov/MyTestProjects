/*
* CLASSES: File contains class declaration for: CMatSignal: For output of signal
* CMatFhrPartVector: For output of fhr parts
*/
#pragma once

#include <string>
#include "DigitalSignal.h"
#include "C:/MATLAB701/extern/include/mat.h"

// Namespace for string operations
//using namespace std;

namespace patterns
{

	class /* LMS__EXT__FLAG__ */ CMatSignal

		// class CMatSignal
	{
		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	public:
		CMatSignal(void);
		virtual ~CMatSignal(void);

		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	protected:
		const double *m_pSignalDouble;	// pointer to existing signal data
		long *m_pSignalLong;
		long m_lSize;					// number of data points
		string m_strOutputFile;
		string m_strOutputVarName;
		bool m_bSaveAsUD;				// if want to save in ud_save structure
		bool m_bIsDouble;				// if true then data is double else is long

		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	public:

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetSignal(const double *p)
		{
			m_pSignalDouble = p;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetSignalLong(long *l)
		{
			m_pSignalLong = l;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetSignalLength(long l)
		{
			m_lSize = l;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetFilename(string str)
		{
			m_strOutputFile = str;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetVarName(string str)
		{
			m_strOutputVarName = str;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetSaveUD(bool b)
		{
			m_bSaveAsUD = b;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetIsDouble(bool b)
		{
			m_bIsDouble = b;
		}

		bool OutputToFile(void);
		bool ReadFromFile(int** pfhr, long* nfhr, int** up, long* nup); 
		string ToInFileString(int* pfhr, long nfhr, int* up, long nup);
		void To3DigStr(char* s, int x);
	};

	class /* LMS__EXT__FLAG__ */ CMatFhrPartSet
	{
		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	public:
		CMatFhrPartSet(void);
		virtual ~CMatFhrPartSet(void);

		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	protected:
		fhrPartSet *m_pFhrParts;
		bool m_bSaveAsUD;
		string m_strOutputFile;

		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	public:

		void SetFhrParts(fhrPartSet *p)
		{
			m_pFhrParts = p;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetFilename(string str)
		{
			m_strOutputFile = str;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetSaveUD(bool b)
		{
			m_bSaveAsUD = b;
		}

		bool OutputToFile(void);
		
	};

	class CMatContractionSet
	{
		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	public:
		CMatContractionSet(void);
		virtual ~CMatContractionSet(void);

		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	protected:
		ContractionDetection *m_pContractions;
		long m_lSize;
		long m_lMaxSize;
		string m_strOutputFile;

		/*
		-------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------
		*/
	public:
		void Add(ContractionDetection c);

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetContractions(ContractionDetection *pC)
		{
			m_pContractions = pC;
		}

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		void SetFilename(string str)
		{
			m_strOutputFile = str;
		}

		bool OutputToFile(void);

		/*
		===============================================================================================================
		===============================================================================================================
		*/
		long GetSize(void)
		{
			return m_lSize;
		}

		long GetLastXEnd(void);
	};
}